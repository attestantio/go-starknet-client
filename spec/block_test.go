// Copyright Â© 2024 Attestant Limited.
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//     http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

package spec_test

import (
	"encoding/json"
	"testing"

	"github.com/attestantio/go-starknet-client/spec"
	"github.com/stretchr/testify/require"
)

func TestBlock(t *testing.T) {
	tests := []struct {
		name     string
		input    []byte
		expected []byte
		err      string
	}{
		{
			name: "Empty",
			err:  "unexpected end of JSON input",
		},
		{
			name:  "JSONBad",
			input: []byte("[]"),
			err:   "json: cannot unmarshal array into Go value of type spec.Block",
		},
		{
			name:  "Full",
			input: []byte(`{"status":"ACCEPTED_ON_L1","block_hash":"0x5c627d4aeb51280058bed93c7889bce78114d63baad1be0f0aeb32496d5f19c","parent_hash":"0x0","block_number":0,"new_root":"0xe005205a1327f3dff98074e528f7b96f30e0624a1dfcf571bdc81948d150a0","timestamp":1700406220,"sequencer_address":"0x1176a1bd84444c89232ec27754698e5d2e7e1a7f1539f12027f28b23ec9f3d8","l1_gas_price":{"price_in_fri":"0x0","price_in_wei":"0x3e617dc5"},"l1_data_gas_price":{"price_in_fri":"0x1","price_in_wei":"0x1"},"l1_da_mode":"CALLDATA","starknet_version":"0.12.3","transactions":[{"transaction":{"transaction_hash":"0x656e113cb27707d2147c271a79c51d1069b0273ae447b965e15154a17b3ec01","type":"DECLARE","version":"0x0","max_fee":"0x0","class_hash":"0x5c478ee27f2112411f86f207605b2e2c58cdb647bac0df27f660ef2252359c6","sender_address":"0x1","signature":[]},"receipt":{"type":"DECLARE","transaction_hash":"0x656e113cb27707d2147c271a79c51d1069b0273ae447b965e15154a17b3ec01","actual_fee":{"amount":"0x0","unit":"WEI"},"execution_status":"SUCCEEDED","finality_status":"ACCEPTED_ON_L1","messages_sent":[],"events":[],"execution_resources":{"steps":2711,"pedersen_builtin_applications":15,"range_check_builtin_applications":63,"data_availability":{"l1_gas":0,"l1_data_gas":0}}}},{"transaction":{"transaction_hash":"0x32538718071ad83ccd09fca03fe3a17add776ec12002d1c4e16ad4b92ddf752","type":"DECLARE","version":"0x0","max_fee":"0x0","class_hash":"0xd0e183745e9dae3e4e78a8ffedcce0903fc4900beace4e0abf192d4c202da3","sender_address":"0x1","signature":[]},"receipt":{"type":"DECLARE","transaction_hash":"0x32538718071ad83ccd09fca03fe3a17add776ec12002d1c4e16ad4b92ddf752","actual_fee":{"amount":"0x0","unit":"WEI"},"execution_status":"SUCCEEDED","finality_status":"ACCEPTED_ON_L1","messages_sent":[],"events":[],"execution_resources":{"steps":2711,"pedersen_builtin_applications":15,"range_check_builtin_applications":63,"data_availability":{"l1_gas":0,"l1_data_gas":0}}}},{"transaction":{"transaction_hash":"0x144f41e654d0916810a83df0fe8984043671200f28df1206f58566144e302dd","type":"DEPLOY_ACCOUNT","version":"0x1","nonce":"0x0","max_fee":"0x0","contract_address_salt":"0x0","class_hash":"0x5c478ee27f2112411f86f207605b2e2c58cdb647bac0df27f660ef2252359c6","constructor_calldata":["0x12c4df40394d06f157edec8d0e64db61fe0c271149ea860c8fe98def29ecf02"],"signature":["0x13f82fd9238dfc8d01543f89be2b5d5589b3eb93d9c3b888f1f94b089768771","0x2c279ec310c4dd58a296fab66b2624640780e79a1c5c87388e6150fb5384a9d"]},"receipt":{"type":"DEPLOY_ACCOUNT","transaction_hash":"0x144f41e654d0916810a83df0fe8984043671200f28df1206f58566144e302dd","actual_fee":{"amount":"0x0","unit":"WEI"},"execution_status":"SUCCEEDED","finality_status":"ACCEPTED_ON_L1","messages_sent":[],"events":[],"contract_address":"0x43abaa073c768ebf039c0c4f46db9acc39e9ec165690418060a652aab39e7d8","execution_resources":{"steps":3863,"pedersen_builtin_applications":23,"range_check_builtin_applications":83,"ecdsa_builtin_applications":1,"data_availability":{"l1_gas":0,"l1_data_gas":0}}}},{"transaction":{"transaction_hash":"0x6a5a493cf33919e58aa4c75777bffdef97c0e39cac968896d7bee8cc67905a1","type":"INVOKE","version":"0x1","nonce":"0x1","max_fee":"0x0","sender_address":"0x43abaa073c768ebf039c0c4f46db9acc39e9ec165690418060a652aab39e7d8","signature":["0x357dbb6c509a7d4b58f8ee7151236278b7959b39f7d05b8f7e2ef20593bdf7e","0x64d5f748eef19ca7f1c8cc533e5c9c85f80ef4f040c75da67bda82f5c58328d"],"calldata":["0x1","0x43abaa073c768ebf039c0c4f46db9acc39e9ec165690418060a652aab39e7d8","0x2730079d734ee55315f4f141eaed376bddd8c2133523d223a344c5604e0f7f8","0x0","0x5","0x5","0xd0e183745e9dae3e4e78a8ffedcce0903fc4900beace4e0abf192d4c202da3","0x322c2610264639f6b2cee681ac53fa65c37e187ea24292d1b21d859c55e1a78","0x1","0x0","0x1"]},"receipt":{"type":"INVOKE","transaction_hash":"0x6a5a493cf33919e58aa4c75777bffdef97c0e39cac968896d7bee8cc67905a1","actual_fee":{"amount":"0x0","unit":"WEI"},"execution_status":"SUCCEEDED","finality_status":"ACCEPTED_ON_L1","messages_sent":[],"events":[],"execution_resources":{"steps":5617,"pedersen_builtin_applications":23,"range_check_builtin_applications":122,"ecdsa_builtin_applications":1,"data_availability":{"l1_gas":0,"l1_data_gas":0}}}},{"transaction":{"transaction_hash":"0x4a5a3a951244f37c97b258465db17ba235dc68fd369c539d763bae99b2cae1","type":"INVOKE","version":"0x1","nonce":"0x2","max_fee":"0x0","sender_address":"0x43abaa073c768ebf039c0c4f46db9acc39e9ec165690418060a652aab39e7d8","signature":["0x6b5baf01bf27386f1544efcf2e91aa69a42a41a9781e24b3cd984a91e815de7","0x2de46894d2f386d25f2258e80f464e05f08daab78df764d87c4381a7eae6c97"],"calldata":["0x1","0x43abaa073c768ebf039c0c4f46db9acc39e9ec165690418060a652aab39e7d8","0x2730079d734ee55315f4f141eaed376bddd8c2133523d223a344c5604e0f7f8","0x0","0x5","0x5","0xd0e183745e9dae3e4e78a8ffedcce0903fc4900beace4e0abf192d4c202da3","0x322c2610264639f6b2cee681ac53fa65c37e187ea24292d1b21d859c55e1a78","0x1","0x0","0x0"]},"receipt":{"type":"INVOKE","transaction_hash":"0x4a5a3a951244f37c97b258465db17ba235dc68fd369c539d763bae99b2cae1","actual_fee":{"amount":"0x0","unit":"WEI"},"execution_status":"SUCCEEDED","finality_status":"ACCEPTED_ON_L1","messages_sent":[],"events":[],"execution_resources":{"steps":5617,"pedersen_builtin_applications":23,"range_check_builtin_applications":122,"ecdsa_builtin_applications":1,"data_availability":{"l1_gas":0,"l1_data_gas":0}}}},{"transaction":{"transaction_hash":"0x1bec64a9f5ff52154b560fd489ae2aabbfcb31062f7ea70c3c674ddf14b0add","type":"INVOKE","version":"0x1","nonce":"0x3","max_fee":"0x0","sender_address":"0x43abaa073c768ebf039c0c4f46db9acc39e9ec165690418060a652aab39e7d8","signature":["0x44580ba3cd68e5d9509d2fcb8bd09933ae4a7b7dfe6744eaa2329f9a79d7408","0x68404a4da22c31d8367f873c043318750a24c669702c72de8518a3d52284b94"],"calldata":["0x1","0x49d36570d4e46f48e99674bd3fcc84644ddd6b96f7c741b1562b82f9e004dc7","0x195d4289b867c3d98c335ea31402667f3592e227faf3d2991308563ed102aab","0x0","0x0","0x0"]},"receipt":{"type":"INVOKE","transaction_hash":"0x1bec64a9f5ff52154b560fd489ae2aabbfcb31062f7ea70c3c674ddf14b0add","actual_fee":{"amount":"0x0","unit":"WEI"},"execution_status":"SUCCEEDED","finality_status":"ACCEPTED_ON_L1","messages_sent":[],"events":[{"from_address":"0x49d36570d4e46f48e99674bd3fcc84644ddd6b96f7c741b1562b82f9e004dc7","keys":["0x3774b0545aabb37c45c1eddc6a7dae57de498aae6d5e3589e362d4b4323a533"],"data":["0x43abaa073c768ebf039c0c4f46db9acc39e9ec165690418060a652aab39e7d8","0x43abaa073c768ebf039c0c4f46db9acc39e9ec165690418060a652aab39e7d8"]},{"from_address":"0x49d36570d4e46f48e99674bd3fcc84644ddd6b96f7c741b1562b82f9e004dc7","keys":["0x4595132f9b33b7077ebf2e7f3eb746a8e0a6d5c337c71cd8f9bf46cac3cfd7"],"data":["0x43abaa073c768ebf039c0c4f46db9acc39e9ec165690418060a652aab39e7d8"]}],"execution_resources":{"steps":4854,"pedersen_builtin_applications":17,"range_check_builtin_applications":106,"ecdsa_builtin_applications":1,"data_availability":{"l1_gas":0,"l1_data_gas":0}}}},{"transaction":{"transaction_hash":"0x72b2d3b79b3da51efe860da954a2f50d23da95f028a456c5356a08e61642754","type":"INVOKE","version":"0x1","nonce":"0x4","max_fee":"0x0","sender_address":"0x43abaa073c768ebf039c0c4f46db9acc39e9ec165690418060a652aab39e7d8","signature":["0x12ef79a31ed2ff357b290f40c8c1bbe53cbb253866f0dc52b25aabbfb443c2b","0x376b2ddfd1ba9c6a0d72e3e4dbc5bbb1f0d2601089999cbf477aed944ae5c03"],"calldata":["0x1","0x4c5772d1914fe6ce891b64eb35bf3522aeae1315647314aac58b01137607f3f","0x195d4289b867c3d98c335ea31402667f3592e227faf3d2991308563ed102aab","0x0","0x0","0x0"]},"receipt":{"type":"INVOKE","transaction_hash":"0x72b2d3b79b3da51efe860da954a2f50d23da95f028a456c5356a08e61642754","actual_fee":{"amount":"0x0","unit":"WEI"},"execution_status":"SUCCEEDED","finality_status":"ACCEPTED_ON_L1","messages_sent":[],"events":[{"from_address":"0x4c5772d1914fe6ce891b64eb35bf3522aeae1315647314aac58b01137607f3f","keys":["0x3774b0545aabb37c45c1eddc6a7dae57de498aae6d5e3589e362d4b4323a533"],"data":["0x43abaa073c768ebf039c0c4f46db9acc39e9ec165690418060a652aab39e7d8","0x43abaa073c768ebf039c0c4f46db9acc39e9ec165690418060a652aab39e7d8"]},{"from_address":"0x4c5772d1914fe6ce891b64eb35bf3522aeae1315647314aac58b01137607f3f","keys":["0x4595132f9b33b7077ebf2e7f3eb746a8e0a6d5c337c71cd8f9bf46cac3cfd7"],"data":["0x43abaa073c768ebf039c0c4f46db9acc39e9ec165690418060a652aab39e7d8"]}],"execution_resources":{"steps":4854,"pedersen_builtin_applications":17,"range_check_builtin_applications":106,"ecdsa_builtin_applications":1,"data_availability":{"l1_gas":0,"l1_data_gas":0}}}}]}`),
			// Ordering is different.
			expected: []byte(`{"status":"ACCEPTED_ON_L1","block_hash":"0x5c627d4aeb51280058bed93c7889bce78114d63baad1be0f0aeb32496d5f19c","parent_hash":"0x0","block_number":0,"new_root":"0xe005205a1327f3dff98074e528f7b96f30e0624a1dfcf571bdc81948d150a0","timestamp":1700406220,"sequencer_address":"0x1176a1bd84444c89232ec27754698e5d2e7e1a7f1539f12027f28b23ec9f3d8","l1_gas_price":{"price_in_fri":"0x0","price_in_wei":"0x3e617dc5"},"l1_data_gas_price":{"price_in_fri":"0x1","price_in_wei":"0x1"},"l1_da_mode":"CALLDATA","starknet_version":"0.12.3","transactions":[{"transaction":{"transaction_hash":"0x656e113cb27707d2147c271a79c51d1069b0273ae447b965e15154a17b3ec01","type":"DECLARE","sender_address":"0x1","max_fee":"0x0","version":"0x0","signature":[],"class_hash":"0x5c478ee27f2112411f86f207605b2e2c58cdb647bac0df27f660ef2252359c6"},"receipt":{"type":"DECLARE","transaction_hash":"0x656e113cb27707d2147c271a79c51d1069b0273ae447b965e15154a17b3ec01","actual_fee":{"amount":"0x0","unit":"WEI"},"execution_status":"SUCCEEDED","finality_status":"ACCEPTED_ON_L1","messages_sent":[],"events":[],"execution_resources":{"steps":2711,"pedersen_builtin_applications":15,"range_check_builtin_applications":63,"data_availability":{"l1_gas":0,"l1_data_gas":0}}}},{"transaction":{"transaction_hash":"0x32538718071ad83ccd09fca03fe3a17add776ec12002d1c4e16ad4b92ddf752","type":"DECLARE","sender_address":"0x1","max_fee":"0x0","version":"0x0","signature":[],"class_hash":"0xd0e183745e9dae3e4e78a8ffedcce0903fc4900beace4e0abf192d4c202da3"},"receipt":{"type":"DECLARE","transaction_hash":"0x32538718071ad83ccd09fca03fe3a17add776ec12002d1c4e16ad4b92ddf752","actual_fee":{"amount":"0x0","unit":"WEI"},"execution_status":"SUCCEEDED","finality_status":"ACCEPTED_ON_L1","messages_sent":[],"events":[],"execution_resources":{"steps":2711,"pedersen_builtin_applications":15,"range_check_builtin_applications":63,"data_availability":{"l1_gas":0,"l1_data_gas":0}}}},{"transaction":{"transaction_hash":"0x144f41e654d0916810a83df0fe8984043671200f28df1206f58566144e302dd","type":"DEPLOY_ACCOUNT","max_fee":"0x0","version":"0x1","signature":["0x13f82fd9238dfc8d01543f89be2b5d5589b3eb93d9c3b888f1f94b089768771","0x2c279ec310c4dd58a296fab66b2624640780e79a1c5c87388e6150fb5384a9d"],"nonce":"0x0","contract_address_salt":"0x0","constructor_calldata":["0x12c4df40394d06f157edec8d0e64db61fe0c271149ea860c8fe98def29ecf02"],"class_hash":"0x5c478ee27f2112411f86f207605b2e2c58cdb647bac0df27f660ef2252359c6"},"receipt":{"type":"DEPLOY_ACCOUNT","transaction_hash":"0x144f41e654d0916810a83df0fe8984043671200f28df1206f58566144e302dd","actual_fee":{"amount":"0x0","unit":"WEI"},"execution_status":"SUCCEEDED","finality_status":"ACCEPTED_ON_L1","messages_sent":[],"events":[],"contract_address":"0x43abaa073c768ebf039c0c4f46db9acc39e9ec165690418060a652aab39e7d8","execution_resources":{"steps":3863,"pedersen_builtin_applications":23,"range_check_builtin_applications":83,"ecdsa_builtin_applications":1,"data_availability":{"l1_gas":0,"l1_data_gas":0}}}},{"transaction":{"transaction_hash":"0x6a5a493cf33919e58aa4c75777bffdef97c0e39cac968896d7bee8cc67905a1","type":"INVOKE","sender_address":"0x43abaa073c768ebf039c0c4f46db9acc39e9ec165690418060a652aab39e7d8","calldata":["0x1","0x43abaa073c768ebf039c0c4f46db9acc39e9ec165690418060a652aab39e7d8","0x2730079d734ee55315f4f141eaed376bddd8c2133523d223a344c5604e0f7f8","0x0","0x5","0x5","0xd0e183745e9dae3e4e78a8ffedcce0903fc4900beace4e0abf192d4c202da3","0x322c2610264639f6b2cee681ac53fa65c37e187ea24292d1b21d859c55e1a78","0x1","0x0","0x1"],"max_fee":"0x0","version":"0x1","signature":["0x357dbb6c509a7d4b58f8ee7151236278b7959b39f7d05b8f7e2ef20593bdf7e","0x64d5f748eef19ca7f1c8cc533e5c9c85f80ef4f040c75da67bda82f5c58328d"],"nonce":"0x1"},"receipt":{"type":"INVOKE","transaction_hash":"0x6a5a493cf33919e58aa4c75777bffdef97c0e39cac968896d7bee8cc67905a1","actual_fee":{"amount":"0x0","unit":"WEI"},"execution_status":"SUCCEEDED","finality_status":"ACCEPTED_ON_L1","messages_sent":[],"events":[],"execution_resources":{"steps":5617,"pedersen_builtin_applications":23,"range_check_builtin_applications":122,"ecdsa_builtin_applications":1,"data_availability":{"l1_gas":0,"l1_data_gas":0}}}},{"transaction":{"transaction_hash":"0x4a5a3a951244f37c97b258465db17ba235dc68fd369c539d763bae99b2cae1","type":"INVOKE","sender_address":"0x43abaa073c768ebf039c0c4f46db9acc39e9ec165690418060a652aab39e7d8","calldata":["0x1","0x43abaa073c768ebf039c0c4f46db9acc39e9ec165690418060a652aab39e7d8","0x2730079d734ee55315f4f141eaed376bddd8c2133523d223a344c5604e0f7f8","0x0","0x5","0x5","0xd0e183745e9dae3e4e78a8ffedcce0903fc4900beace4e0abf192d4c202da3","0x322c2610264639f6b2cee681ac53fa65c37e187ea24292d1b21d859c55e1a78","0x1","0x0","0x0"],"max_fee":"0x0","version":"0x1","signature":["0x6b5baf01bf27386f1544efcf2e91aa69a42a41a9781e24b3cd984a91e815de7","0x2de46894d2f386d25f2258e80f464e05f08daab78df764d87c4381a7eae6c97"],"nonce":"0x2"},"receipt":{"type":"INVOKE","transaction_hash":"0x4a5a3a951244f37c97b258465db17ba235dc68fd369c539d763bae99b2cae1","actual_fee":{"amount":"0x0","unit":"WEI"},"execution_status":"SUCCEEDED","finality_status":"ACCEPTED_ON_L1","messages_sent":[],"events":[],"execution_resources":{"steps":5617,"pedersen_builtin_applications":23,"range_check_builtin_applications":122,"ecdsa_builtin_applications":1,"data_availability":{"l1_gas":0,"l1_data_gas":0}}}},{"transaction":{"transaction_hash":"0x1bec64a9f5ff52154b560fd489ae2aabbfcb31062f7ea70c3c674ddf14b0add","type":"INVOKE","sender_address":"0x43abaa073c768ebf039c0c4f46db9acc39e9ec165690418060a652aab39e7d8","calldata":["0x1","0x49d36570d4e46f48e99674bd3fcc84644ddd6b96f7c741b1562b82f9e004dc7","0x195d4289b867c3d98c335ea31402667f3592e227faf3d2991308563ed102aab","0x0","0x0","0x0"],"max_fee":"0x0","version":"0x1","signature":["0x44580ba3cd68e5d9509d2fcb8bd09933ae4a7b7dfe6744eaa2329f9a79d7408","0x68404a4da22c31d8367f873c043318750a24c669702c72de8518a3d52284b94"],"nonce":"0x3"},"receipt":{"type":"INVOKE","transaction_hash":"0x1bec64a9f5ff52154b560fd489ae2aabbfcb31062f7ea70c3c674ddf14b0add","actual_fee":{"amount":"0x0","unit":"WEI"},"execution_status":"SUCCEEDED","finality_status":"ACCEPTED_ON_L1","messages_sent":[],"events":[{"from_address":"0x49d36570d4e46f48e99674bd3fcc84644ddd6b96f7c741b1562b82f9e004dc7","keys":["0x3774b0545aabb37c45c1eddc6a7dae57de498aae6d5e3589e362d4b4323a533"],"data":["0x43abaa073c768ebf039c0c4f46db9acc39e9ec165690418060a652aab39e7d8","0x43abaa073c768ebf039c0c4f46db9acc39e9ec165690418060a652aab39e7d8"]},{"from_address":"0x49d36570d4e46f48e99674bd3fcc84644ddd6b96f7c741b1562b82f9e004dc7","keys":["0x4595132f9b33b7077ebf2e7f3eb746a8e0a6d5c337c71cd8f9bf46cac3cfd7"],"data":["0x43abaa073c768ebf039c0c4f46db9acc39e9ec165690418060a652aab39e7d8"]}],"execution_resources":{"steps":4854,"pedersen_builtin_applications":17,"range_check_builtin_applications":106,"ecdsa_builtin_applications":1,"data_availability":{"l1_gas":0,"l1_data_gas":0}}}},{"transaction":{"transaction_hash":"0x72b2d3b79b3da51efe860da954a2f50d23da95f028a456c5356a08e61642754","type":"INVOKE","sender_address":"0x43abaa073c768ebf039c0c4f46db9acc39e9ec165690418060a652aab39e7d8","calldata":["0x1","0x4c5772d1914fe6ce891b64eb35bf3522aeae1315647314aac58b01137607f3f","0x195d4289b867c3d98c335ea31402667f3592e227faf3d2991308563ed102aab","0x0","0x0","0x0"],"max_fee":"0x0","version":"0x1","signature":["0x12ef79a31ed2ff357b290f40c8c1bbe53cbb253866f0dc52b25aabbfb443c2b","0x376b2ddfd1ba9c6a0d72e3e4dbc5bbb1f0d2601089999cbf477aed944ae5c03"],"nonce":"0x4"},"receipt":{"type":"INVOKE","transaction_hash":"0x72b2d3b79b3da51efe860da954a2f50d23da95f028a456c5356a08e61642754","actual_fee":{"amount":"0x0","unit":"WEI"},"execution_status":"SUCCEEDED","finality_status":"ACCEPTED_ON_L1","messages_sent":[],"events":[{"from_address":"0x4c5772d1914fe6ce891b64eb35bf3522aeae1315647314aac58b01137607f3f","keys":["0x3774b0545aabb37c45c1eddc6a7dae57de498aae6d5e3589e362d4b4323a533"],"data":["0x43abaa073c768ebf039c0c4f46db9acc39e9ec165690418060a652aab39e7d8","0x43abaa073c768ebf039c0c4f46db9acc39e9ec165690418060a652aab39e7d8"]},{"from_address":"0x4c5772d1914fe6ce891b64eb35bf3522aeae1315647314aac58b01137607f3f","keys":["0x4595132f9b33b7077ebf2e7f3eb746a8e0a6d5c337c71cd8f9bf46cac3cfd7"],"data":["0x43abaa073c768ebf039c0c4f46db9acc39e9ec165690418060a652aab39e7d8"]}],"execution_resources":{"steps":4854,"pedersen_builtin_applications":17,"range_check_builtin_applications":106,"ecdsa_builtin_applications":1,"data_availability":{"l1_gas":0,"l1_data_gas":0}}}}]}`),
		},
		{
			name:     "Data",
			input:    []byte(`{"status":"ACCEPTED_ON_L2","block_hash":"0x6b1bf09cd6b0b29019678ed01023b92bb95e40e3a005611069cc4afbd1c6987","parent_hash":"0x2dff7caa2a524ee36220678eff01701ad6d0b3011e66a726255cedd7793b00c","block_number":309238,"new_root":"0x167c25b0ab9bf8d6fab52b88f6a22f7f71016e12aa35e33ff964bc9235e0076","timestamp":1731489605,"sequencer_address":"0x1176a1bd84444c89232ec27754698e5d2e7e1a7f1539f12027f28b23ec9f3d8","l1_gas_price":{"price_in_fri":"0x138b7faa1a70","price_in_wei":"0xbb168f73"},"l1_data_gas_price":{"price_in_fri":"0x55a","price_in_wei":"0x1"},"l1_da_mode":"BLOB","starknet_version":"0.13.3","transactions":[{"transaction":{"transaction_hash":"0xe645d86367a0ada43b9e7a9540ebe1041fbc41f764b9dda7b0a95e35e79f66","type":"INVOKE","version":"0x1","nonce":"0x2187","max_fee":"0x3221584e26b107f","sender_address":"0x5407d8d28c43c10bdb7193b2c1553ab881ca77eb2ebc24c1ab02e848455dd99","signature":["0x5c459c0ba53e5263f515f57dadc9c9ae3333005e319df67050486ff0796de1a","0x1d8384ad0bba6e906ac3d7b42e46f7e31f85ad68fcec37e9973ebf1cdbcbccd"],"calldata":["0x1","0x45d7ee9d09775970ea605625fd652cea72a6ccd973e2f472f35c33ffcf30b73","0x7ec457cd7ed1630225a8328f826a29a327b19486f6b2882b4176545ebdbe3d","0x28","0x5407d8d28c43c10bdb7193b2c1553ab881ca77eb2ebc24c1ab02e848455dd99","0x0","0x0","0xffffffff","0x1","0x1d2e513630d8120666fc6e7d52ad0c01479fd99c183baac79fff9135f46e359","0x7099f594eb65e00576e1b940a8a735f80bf7604ac401c48627045c4cc286f0","0x0","0x18","0x18","0x2b8","0x2f902b487034550b76e40650f02028307a120940461756ea718454d730acf","0xa13174be628212af3872386f26fc10000b902843593564c00000000000000","0x60000000000000","0xa00000000000","0x9184e72a00000000000","0x20b0000","0x0","0x200","0x40","0x0","0xa0000000000000000000000000000000000000000000000000000000000000","0x400000000000000000000000000000000000000000000000000000000000","0x2000000000000000000000000000000000000000000000000002386f2","0x6fc10000000000000000000000000000000000000000000000000000000000","0x100000000000000000000000000f2752c24f5e13df4fba947d6f2e3","0x683d739da69a00000000000000000000000000000000000000000000000000","0x2386f26fc10000000000000000000000000000000000000000000000000000","0x1599e7f0000000000000000000000000000000000000000000000","0xa000000000000000000000000000000000000000000000","0x0","0x2be7f1725e7734ce288f8367e1bb143e90bb3f0512","0x641b4c0bc8703d3af59322849be01559fdb920c9040000000000000000","0xc0","0x5","0xf5fb7577296b6258acc7bffe3c2b8768","0x6ccdbc75b79c4cf456fcb61cf4c7fd7e","0x59567c7f7f42afb201b855e98d3cd7f4","0xc57939578f1421c4d4a0a0b49bfff09","0x0"]},"receipt":{"type":"INVOKE","transaction_hash":"0xe645d86367a0ada43b9e7a9540ebe1041fbc41f764b9dda7b0a95e35e79f66","actual_fee":{"amount":"0x5928c05d4e","unit":"WEI"},"execution_status":"REVERTED","finality_status":"ACCEPTED_ON_L2","messages_sent":[],"events":[{"from_address":"0x49d36570d4e46f48e99674bd3fcc84644ddd6b96f7c741b1562b82f9e004dc7","keys":["0x99cd8bde557814842a3121e8ddfd433a539b8c9f14bf31ebf108d12e6196e9"],"data":["0x5407d8d28c43c10bdb7193b2c1553ab881ca77eb2ebc24c1ab02e848455dd99","0x1176a1bd84444c89232ec27754698e5d2e7e1a7f1539f12027f28b23ec9f3d8","0x5928c05d4e","0x0"]}],"revert_reason":"Transaction execution has failed:\n0: Error in the called contract (contract address: 0x05407d8d28c43c10bdb7193b2c1553ab881ca77eb2ebc24c1ab02e848455dd99, class hash: 0x061dac032f228abef9c6626f995015233097ae253a7f72d68552db02f2971b8f, selector: 0x015d40a3d6ca2ac30f4031e42be28da9b056fef9bb7357ac5e85627ee876e5ad):\nError at pc=0:4835:\nCairo traceback (most recent call last):\nUnknown location (pc=0:67)\nUnknown location (pc=0:1835)\nUnknown location (pc=0:2554)\nUnknown location (pc=0:3436)\nUnknown location (pc=0:4040)\n\n1: Error in the called contract (contract address: 0x045d7ee9d09775970ea605625fd652cea72a6ccd973e2f472f35c33ffcf30b73, class hash: 0x07b2de5e73ff7eb338d76c967dd5aa3f3004574d326b8c1402bb819d4983b8b6, selector: 0x007ec457cd7ed1630225a8328f826a29a327b19486f6b2882b4176545ebdbe3d):\nError at pc=0:22:\nCairo traceback (most recent call last):\nUnknown location (pc=0:273)\nUnknown location (pc=0:259)\n\n2: Error in a library call (contract address: 0x045d7ee9d09775970ea605625fd652cea72a6ccd973e2f472f35c33ffcf30b73, class hash: 0x024d700216e7f5a33f7e1426b550bcbba17acd52c5c645ba1e01e783b5cbafab, selector: 0x007ec457cd7ed1630225a8328f826a29a327b19486f6b2882b4176545ebdbe3d):\nError at pc=0:32:\nCairo traceback (most recent call last):\nUnknown location (pc=0:3247)\nUnknown location (pc=0:3180)\nUnknown location (pc=0:2614)\nUnknown location (pc=0:445)\n\n3: Error in the called contract (contract address: 0x01d2e513630d8120666fc6e7d52ad0c01479fd99c183baac79fff9135f46e359, class hash: 0x04a548d70f5f30756d77eda35f9d7b8ec34edc51ccd1f045bc2e0ba29f4cc5cd, selector: 0x01df22f179266780b29ce26485abf97cbd909fd15ce74a37b793bcd261f84b14):\nError message: Invalid nonce\nError at pc=0:26335:\nCairo traceback (most recent call last):\nUnknown location (pc=0:26487)\n\nAn ASSERT_EQ instruction failed: 16 != 15.\n","execution_resources":{"steps":46654,"pedersen_builtin_applications":58,"range_check_builtin_applications":195,"ec_op_builtin_applications":3,"poseidon_builtin_applications":3,"data_availability":{"l1_gas":0,"l1_data_gas":128}}}},{"transaction":{"transaction_hash":"0x64a3b4750f807956501570d23565a637357c13a1f405e5d883bf7072f2df912","type":"INVOKE","version":"0x1","nonce":"0x6208","max_fee":"0xaa87bee538000","sender_address":"0x279fde026e3e6cceacb9c263fece0c8d66a8f59e8448f3da5a1968976841c62","signature":["0x71aa7baa67e388adfa31da8c3ded4c397e939d44a24dea1230238a6bf83a8fa","0x450e6e12c8e4271b5b7e91cb13c65411f35cf986292eda4ffb4b3378f8a190c"],"calldata":["0x1","0x36031daa264c24520b11d93af622c848b2499b66b41d611bac95e13cfca131a","0x3d0bcca55c118f88a08e0fcc06f43906c0c174feb52ebc83f0fa28a1f59ed67","0x55","0xc","0x0","0x67346f49","0x41564e55","0x41564e55","0x49c7851400","0x4554482f555344","0x0","0x0","0x67346f49","0x41564e55","0x41564e55","0x2c023eb","0x5354524b2f555344","0x0","0x0","0x67346f49","0x41564e55","0x41564e55","0x7f2691c1a01","0x574254432f555344","0x0","0x0","0x67346f49","0x41564e55","0x41564e55","0x57568473d9","0x5753544554482f555344","0x0","0x0","0x67346f49","0x41564e55","0x41564e55","0x78dd9a","0x4c4f5244532f555344","0x0","0x0","0x67346f49","0x41564e55","0x41564e55","0x36ce7065","0x554e492f555344","0x0","0x0","0x67346f49","0x41564e55","0x41564e55","0xf42e3","0x555344432f555344","0x0","0x0","0x67346f49","0x41564e55","0x41564e55","0xf46f9","0x555344542f555344","0x0","0x0","0x67346f49","0x41564e55","0x41564e55","0x5074d59ad2","0x524554482f555344","0x0","0x0","0x67346f49","0x41564e55","0x41564e55","0x92f434","0x5a454e442f555344","0x0","0x0","0x67346f49","0x41564e55","0x41564e55","0x8bc48d","0x4e5354522f555344","0x0","0x0","0x67346f49","0x41564e55","0x41564e55","0x10911160","0x454b55424f2f555344","0x0"]},"receipt":{"type":"INVOKE","transaction_hash":"0x64a3b4750f807956501570d23565a637357c13a1f405e5d883bf7072f2df912","actual_fee":{"amount":"0xa3b3bd8860","unit":"WEI"},"execution_status":"SUCCEEDED","finality_status":"ACCEPTED_ON_L2","messages_sent":[],"events":[{"from_address":"0x36031daa264c24520b11d93af622c848b2499b66b41d611bac95e13cfca131a","keys":["0x280bb2099800026f90c334a3a23888ffe718a2920ffbbf4f44c6d3d5efb613c"],"data":["0x67346f49","0x41564e55","0x41564e55","0x49c7851400","0x4554482f555344","0x0"]},{"from_address":"0x36031daa264c24520b11d93af622c848b2499b66b41d611bac95e13cfca131a","keys":["0x280bb2099800026f90c334a3a23888ffe718a2920ffbbf4f44c6d3d5efb613c"],"data":["0x67346f49","0x41564e55","0x41564e55","0x2c023eb","0x5354524b2f555344","0x0"]},{"from_address":"0x36031daa264c24520b11d93af622c848b2499b66b41d611bac95e13cfca131a","keys":["0x280bb2099800026f90c334a3a23888ffe718a2920ffbbf4f44c6d3d5efb613c"],"data":["0x67346f49","0x41564e55","0x41564e55","0x7f2691c1a01","0x574254432f555344","0x0"]},{"from_address":"0x36031daa264c24520b11d93af622c848b2499b66b41d611bac95e13cfca131a","keys":["0x280bb2099800026f90c334a3a23888ffe718a2920ffbbf4f44c6d3d5efb613c"],"data":["0x67346f49","0x41564e55","0x41564e55","0x57568473d9","0x5753544554482f555344","0x0"]},{"from_address":"0x36031daa264c24520b11d93af622c848b2499b66b41d611bac95e13cfca131a","keys":["0x280bb2099800026f90c334a3a23888ffe718a2920ffbbf4f44c6d3d5efb613c"],"data":["0x67346f49","0x41564e55","0x41564e55","0x78dd9a","0x4c4f5244532f555344","0x0"]},{"from_address":"0x36031daa264c24520b11d93af622c848b2499b66b41d611bac95e13cfca131a","keys":["0x280bb2099800026f90c334a3a23888ffe718a2920ffbbf4f44c6d3d5efb613c"],"data":["0x67346f49","0x41564e55","0x41564e55","0x36ce7065","0x554e492f555344","0x0"]},{"from_address":"0x36031daa264c24520b11d93af622c848b2499b66b41d611bac95e13cfca131a","keys":["0x280bb2099800026f90c334a3a23888ffe718a2920ffbbf4f44c6d3d5efb613c"],"data":["0x67346f49","0x41564e55","0x41564e55","0xf42e3","0x555344432f555344","0x0"]},{"from_address":"0x36031daa264c24520b11d93af622c848b2499b66b41d611bac95e13cfca131a","keys":["0x280bb2099800026f90c334a3a23888ffe718a2920ffbbf4f44c6d3d5efb613c"],"data":["0x67346f49","0x41564e55","0x41564e55","0xf46f9","0x555344542f555344","0x0"]},{"from_address":"0x36031daa264c24520b11d93af622c848b2499b66b41d611bac95e13cfca131a","keys":["0x280bb2099800026f90c334a3a23888ffe718a2920ffbbf4f44c6d3d5efb613c"],"data":["0x67346f49","0x41564e55","0x41564e55","0x5074d59ad2","0x524554482f555344","0x0"]},{"from_address":"0x36031daa264c24520b11d93af622c848b2499b66b41d611bac95e13cfca131a","keys":["0x280bb2099800026f90c334a3a23888ffe718a2920ffbbf4f44c6d3d5efb613c"],"data":["0x67346f49","0x41564e55","0x41564e55","0x92f434","0x5a454e442f555344","0x0"]},{"from_address":"0x36031daa264c24520b11d93af622c848b2499b66b41d611bac95e13cfca131a","keys":["0x280bb2099800026f90c334a3a23888ffe718a2920ffbbf4f44c6d3d5efb613c"],"data":["0x67346f49","0x41564e55","0x41564e55","0x8bc48d","0x4e5354522f555344","0x0"]},{"from_address":"0x36031daa264c24520b11d93af622c848b2499b66b41d611bac95e13cfca131a","keys":["0x280bb2099800026f90c334a3a23888ffe718a2920ffbbf4f44c6d3d5efb613c"],"data":["0x67346f49","0x41564e55","0x41564e55","0x10911160","0x454b55424f2f555344","0x0"]},{"from_address":"0x279fde026e3e6cceacb9c263fece0c8d66a8f59e8448f3da5a1968976841c62","keys":["0x1dcde06aabdbca2f80aa51392b345d7549d7757aa855f7e37f5d335ac8243b1","0x64a3b4750f807956501570d23565a637357c13a1f405e5d883bf7072f2df912"],"data":["0x1","0x0"]},{"from_address":"0x49d36570d4e46f48e99674bd3fcc84644ddd6b96f7c741b1562b82f9e004dc7","keys":["0x99cd8bde557814842a3121e8ddfd433a539b8c9f14bf31ebf108d12e6196e9"],"data":["0x279fde026e3e6cceacb9c263fece0c8d66a8f59e8448f3da5a1968976841c62","0x1176a1bd84444c89232ec27754698e5d2e7e1a7f1539f12027f28b23ec9f3d8","0xa3b3bd8860","0x0"]}],"execution_resources":{"steps":79623,"pedersen_builtin_applications":367,"range_check_builtin_applications":2738,"bitwise_builtin_applications":36,"ec_op_builtin_applications":3,"poseidon_builtin_applications":16,"data_availability":{"l1_gas":0,"l1_data_gas":960}}}},{"transaction":{"transaction_hash":"0x3615ebc940bed129609d3d64835b58923d2e7fc3d9bac81caa82829643ff7c0","type":"DEPLOY_ACCOUNT","version":"0x3","nonce":"0x0","contract_address_salt":"0x1520ebb9463c0753e3741d9a87eb6dca5a446c1872544e43dd1a77446465467","class_hash":"0x36078334509b514626504edc9fb252328d1a240e4e948bef8d0c08dff45927f","constructor_calldata":["0x0","0x1520ebb9463c0753e3741d9a87eb6dca5a446c1872544e43dd1a77446465467","0x1"],"signature":["0x1","0x0","0x1520ebb9463c0753e3741d9a87eb6dca5a446c1872544e43dd1a77446465467","0x5f57e800b78abf04200d6de245cfb37ed97dfb1cac4acce5db911e807112d62","0x687be0ae0882738e1040fa7568c2e1fbe52bd019e81fb81eb25ffcd5ec32f26"],"resource_bounds":{"l1_gas":{"max_amount":"0x32","max_price_per_unit":"0x1d513f7e94ae"},"l2_gas":{"max_amount":"0x0","max_price_per_unit":"0x0"}},"tip":"0x0","paymaster_data":[],"nonce_data_availability_mode":"L1","fee_data_availability_mode":"L1"},"receipt":{"type":"DEPLOY_ACCOUNT","transaction_hash":"0x3615ebc940bed129609d3d64835b58923d2e7fc3d9bac81caa82829643ff7c0","actual_fee":{"amount":"0x186e5f94ebf80","unit":"FRI"},"execution_status":"SUCCEEDED","finality_status":"ACCEPTED_ON_L2","messages_sent":[],"events":[{"from_address":"0x5bf379bce33fcf18975ca2195687b4fef201886fa29d9347771e5683735504b","keys":["0x302b4aa3237648863fc569a648f3625780753ababf66d86fd6f7e7bbc648c63","0x5896bcca3ba4617b56aa10418b31e98efcfc7960f9d03c563b4225275fcb95c"],"data":["0x0","0x1520ebb9463c0753e3741d9a87eb6dca5a446c1872544e43dd1a77446465467"]},{"from_address":"0x5bf379bce33fcf18975ca2195687b4fef201886fa29d9347771e5683735504b","keys":["0x1d9ca8a89626bead91b5cb4275a622219e9443975b34f3fdbc683e8621231a9","0x1520ebb9463c0753e3741d9a87eb6dca5a446c1872544e43dd1a77446465467"],"data":["0x0"]},{"from_address":"0x5bf379bce33fcf18975ca2195687b4fef201886fa29d9347771e5683735504b","keys":["0x20609eed4f18b29b5ad13e483b8ab69924632ea4816a40dd30e75437a096abd","0x5896bcca3ba4617b56aa10418b31e98efcfc7960f9d03c563b4225275fcb95c"],"data":["0x0"]},{"from_address":"0x4718f5a0fc34cc1af16a1cdee98ffb20c31f5cd61d6ab07201858f4287c938d","keys":["0x99cd8bde557814842a3121e8ddfd433a539b8c9f14bf31ebf108d12e6196e9"],"data":["0x5bf379bce33fcf18975ca2195687b4fef201886fa29d9347771e5683735504b","0x1176a1bd84444c89232ec27754698e5d2e7e1a7f1539f12027f28b23ec9f3d8","0x186e5f94ebf80","0x0"]}],"contract_address":"0x5bf379bce33fcf18975ca2195687b4fef201886fa29d9347771e5683735504b","execution_resources":{"steps":6647,"pedersen_builtin_applications":29,"range_check_builtin_applications":211,"ec_op_builtin_applications":3,"poseidon_builtin_applications":5,"data_availability":{"l1_gas":0,"l1_data_gas":224}}}},{"transaction":{"transaction_hash":"0x79332353ad7672e0da61caa6a2f3b17a5a46746c959d6a7ff2990e94c51cb00","type":"INVOKE","version":"0x3","nonce":"0x1","sender_address":"0x5bf379bce33fcf18975ca2195687b4fef201886fa29d9347771e5683735504b","signature":["0x1","0x0","0x1520ebb9463c0753e3741d9a87eb6dca5a446c1872544e43dd1a77446465467","0x47e3c137e33970cec36f76fb58ab888b83a3e3a1bca594de9ef9ba2d5bc28ad","0x195265112d9e701360337310f8c09074cb1a025b2efb0c32d2bfe786c1f775e"],"calldata":["0x2","0x4718f5a0fc34cc1af16a1cdee98ffb20c31f5cd61d6ab07201858f4287c938d","0x83afd3f4caedc6eebf44246fe54e38c95e3179a5ec9ea81740eca5b482d12e","0x3","0x7d33254052409c04510c3652bc5be5656f1eff1b131c7c031592e3fa73f1f70","0x3723a4595d950000","0x0","0x4c5772d1914fe6ce891b64eb35bf3522aeae1315647314aac58b01137607f3f","0xe5b455a836c7a254df57ed39d023d46b641b331162c6c0b369647056655409","0x4","0x455448","0x117ffa811b0620decb2b3df649ff3a5ec533fc0e","0x16345785d8a0000","0x0"],"resource_bounds":{"l1_gas":{"max_amount":"0x17ad4","max_price_per_unit":"0x1d513f7edbf3"},"l2_gas":{"max_amount":"0x0","max_price_per_unit":"0x0"}},"tip":"0x0","paymaster_data":[],"account_deployment_data":[],"nonce_data_availability_mode":"L1","fee_data_availability_mode":"L1"},"receipt":{"type":"INVOKE","transaction_hash":"0x79332353ad7672e0da61caa6a2f3b17a5a46746c959d6a7ff2990e94c51cb00","actual_fee":{"amount":"0x9a462b41fe0e5d0","unit":"FRI"},"execution_status":"SUCCEEDED","finality_status":"ACCEPTED_ON_L2","messages_sent":[{"from_address":"0x4c5772d1914fe6ce891b64eb35bf3522aeae1315647314aac58b01137607f3f","to_address":"0x8453fc6cd1bcfe8d4dfc069c400b433054d47bdc","payload":["0x0","0x117ffa811b0620decb2b3df649ff3a5ec533fc0e","0x455448","0x16345785d8a0000","0x0"]}],"events":[{"from_address":"0x4718f5a0fc34cc1af16a1cdee98ffb20c31f5cd61d6ab07201858f4287c938d","keys":["0x99cd8bde557814842a3121e8ddfd433a539b8c9f14bf31ebf108d12e6196e9"],"data":["0x5bf379bce33fcf18975ca2195687b4fef201886fa29d9347771e5683735504b","0x7d33254052409c04510c3652bc5be5656f1eff1b131c7c031592e3fa73f1f70","0x3723a4595d950000","0x0"]},{"from_address":"0x49d36570d4e46f48e99674bd3fcc84644ddd6b96f7c741b1562b82f9e004dc7","keys":["0x99cd8bde557814842a3121e8ddfd433a539b8c9f14bf31ebf108d12e6196e9"],"data":["0x5bf379bce33fcf18975ca2195687b4fef201886fa29d9347771e5683735504b","0x0","0x16345785d8a0000","0x0"]},{"from_address":"0x4c5772d1914fe6ce891b64eb35bf3522aeae1315647314aac58b01137607f3f","keys":["0x282f521c69b2bc696552b9e141009d3c84f2df75e2e7b7716644d31e60f23b1","0x455448","0x117ffa811b0620decb2b3df649ff3a5ec533fc0e","0x5bf379bce33fcf18975ca2195687b4fef201886fa29d9347771e5683735504b"],"data":["0x16345785d8a0000","0x0"]},{"from_address":"0x5bf379bce33fcf18975ca2195687b4fef201886fa29d9347771e5683735504b","keys":["0x1dcde06aabdbca2f80aa51392b345d7549d7757aa855f7e37f5d335ac8243b1","0x79332353ad7672e0da61caa6a2f3b17a5a46746c959d6a7ff2990e94c51cb00"],"data":["0x2","0x1","0x1","0x0"]},{"from_address":"0x4718f5a0fc34cc1af16a1cdee98ffb20c31f5cd61d6ab07201858f4287c938d","keys":["0x99cd8bde557814842a3121e8ddfd433a539b8c9f14bf31ebf108d12e6196e9"],"data":["0x5bf379bce33fcf18975ca2195687b4fef201886fa29d9347771e5683735504b","0x1176a1bd84444c89232ec27754698e5d2e7e1a7f1539f12027f28b23ec9f3d8","0x9a462b41fe0e5d0","0x0"]}],"execution_resources":{"steps":16660,"pedersen_builtin_applications":37,"range_check_builtin_applications":525,"ec_op_builtin_applications":3,"poseidon_builtin_applications":7,"data_availability":{"l1_gas":0,"l1_data_gas":384}}}}]}`),
			expected: []byte(`{"status":"ACCEPTED_ON_L2","block_hash":"0x6b1bf09cd6b0b29019678ed01023b92bb95e40e3a005611069cc4afbd1c6987","parent_hash":"0x2dff7caa2a524ee36220678eff01701ad6d0b3011e66a726255cedd7793b00c","block_number":309238,"new_root":"0x167c25b0ab9bf8d6fab52b88f6a22f7f71016e12aa35e33ff964bc9235e0076","timestamp":1731489605,"sequencer_address":"0x1176a1bd84444c89232ec27754698e5d2e7e1a7f1539f12027f28b23ec9f3d8","l1_gas_price":{"price_in_fri":"0x138b7faa1a70","price_in_wei":"0xbb168f73"},"l1_data_gas_price":{"price_in_fri":"0x55a","price_in_wei":"0x1"},"l1_da_mode":"BLOB","starknet_version":"0.13.3","transactions":[{"transaction":{"transaction_hash":"0xe645d86367a0ada43b9e7a9540ebe1041fbc41f764b9dda7b0a95e35e79f66","type":"INVOKE","sender_address":"0x5407d8d28c43c10bdb7193b2c1553ab881ca77eb2ebc24c1ab02e848455dd99","calldata":["0x1","0x45d7ee9d09775970ea605625fd652cea72a6ccd973e2f472f35c33ffcf30b73","0x7ec457cd7ed1630225a8328f826a29a327b19486f6b2882b4176545ebdbe3d","0x28","0x5407d8d28c43c10bdb7193b2c1553ab881ca77eb2ebc24c1ab02e848455dd99","0x0","0x0","0xffffffff","0x1","0x1d2e513630d8120666fc6e7d52ad0c01479fd99c183baac79fff9135f46e359","0x7099f594eb65e00576e1b940a8a735f80bf7604ac401c48627045c4cc286f0","0x0","0x18","0x18","0x2b8","0x2f902b487034550b76e40650f02028307a120940461756ea718454d730acf","0xa13174be628212af3872386f26fc10000b902843593564c00000000000000","0x60000000000000","0xa00000000000","0x9184e72a00000000000","0x20b0000","0x0","0x200","0x40","0x0","0xa0000000000000000000000000000000000000000000000000000000000000","0x400000000000000000000000000000000000000000000000000000000000","0x2000000000000000000000000000000000000000000000000002386f2","0x6fc10000000000000000000000000000000000000000000000000000000000","0x100000000000000000000000000f2752c24f5e13df4fba947d6f2e3","0x683d739da69a00000000000000000000000000000000000000000000000000","0x2386f26fc10000000000000000000000000000000000000000000000000000","0x1599e7f0000000000000000000000000000000000000000000000","0xa000000000000000000000000000000000000000000000","0x0","0x2be7f1725e7734ce288f8367e1bb143e90bb3f0512","0x641b4c0bc8703d3af59322849be01559fdb920c9040000000000000000","0xc0","0x5","0xf5fb7577296b6258acc7bffe3c2b8768","0x6ccdbc75b79c4cf456fcb61cf4c7fd7e","0x59567c7f7f42afb201b855e98d3cd7f4","0xc57939578f1421c4d4a0a0b49bfff09","0x0"],"max_fee":"0x3221584e26b107f","version":"0x1","signature":["0x5c459c0ba53e5263f515f57dadc9c9ae3333005e319df67050486ff0796de1a","0x1d8384ad0bba6e906ac3d7b42e46f7e31f85ad68fcec37e9973ebf1cdbcbccd"],"nonce":"0x2187"},"receipt":{"type":"INVOKE","transaction_hash":"0xe645d86367a0ada43b9e7a9540ebe1041fbc41f764b9dda7b0a95e35e79f66","actual_fee":{"amount":"0x5928c05d4e","unit":"WEI"},"execution_status":"REVERTED","finality_status":"ACCEPTED_ON_L2","messages_sent":[],"revert_reason":"Transaction execution has failed:\n0: Error in the called contract (contract address: 0x05407d8d28c43c10bdb7193b2c1553ab881ca77eb2ebc24c1ab02e848455dd99, class hash: 0x061dac032f228abef9c6626f995015233097ae253a7f72d68552db02f2971b8f, selector: 0x015d40a3d6ca2ac30f4031e42be28da9b056fef9bb7357ac5e85627ee876e5ad):\nError at pc=0:4835:\nCairo traceback (most recent call last):\nUnknown location (pc=0:67)\nUnknown location (pc=0:1835)\nUnknown location (pc=0:2554)\nUnknown location (pc=0:3436)\nUnknown location (pc=0:4040)\n\n1: Error in the called contract (contract address: 0x045d7ee9d09775970ea605625fd652cea72a6ccd973e2f472f35c33ffcf30b73, class hash: 0x07b2de5e73ff7eb338d76c967dd5aa3f3004574d326b8c1402bb819d4983b8b6, selector: 0x007ec457cd7ed1630225a8328f826a29a327b19486f6b2882b4176545ebdbe3d):\nError at pc=0:22:\nCairo traceback (most recent call last):\nUnknown location (pc=0:273)\nUnknown location (pc=0:259)\n\n2: Error in a library call (contract address: 0x045d7ee9d09775970ea605625fd652cea72a6ccd973e2f472f35c33ffcf30b73, class hash: 0x024d700216e7f5a33f7e1426b550bcbba17acd52c5c645ba1e01e783b5cbafab, selector: 0x007ec457cd7ed1630225a8328f826a29a327b19486f6b2882b4176545ebdbe3d):\nError at pc=0:32:\nCairo traceback (most recent call last):\nUnknown location (pc=0:3247)\nUnknown location (pc=0:3180)\nUnknown location (pc=0:2614)\nUnknown location (pc=0:445)\n\n3: Error in the called contract (contract address: 0x01d2e513630d8120666fc6e7d52ad0c01479fd99c183baac79fff9135f46e359, class hash: 0x04a548d70f5f30756d77eda35f9d7b8ec34edc51ccd1f045bc2e0ba29f4cc5cd, selector: 0x01df22f179266780b29ce26485abf97cbd909fd15ce74a37b793bcd261f84b14):\nError message: Invalid nonce\nError at pc=0:26335:\nCairo traceback (most recent call last):\nUnknown location (pc=0:26487)\n\nAn ASSERT_EQ instruction failed: 16 != 15.\n","events":[{"from_address":"0x49d36570d4e46f48e99674bd3fcc84644ddd6b96f7c741b1562b82f9e004dc7","keys":["0x99cd8bde557814842a3121e8ddfd433a539b8c9f14bf31ebf108d12e6196e9"],"data":["0x5407d8d28c43c10bdb7193b2c1553ab881ca77eb2ebc24c1ab02e848455dd99","0x1176a1bd84444c89232ec27754698e5d2e7e1a7f1539f12027f28b23ec9f3d8","0x5928c05d4e","0x0"]}],"execution_resources":{"steps":46654,"pedersen_builtin_applications":58,"range_check_builtin_applications":195,"ec_op_builtin_applications":3,"poseidon_builtin_applications":3,"data_availability":{"l1_gas":0,"l1_data_gas":128}}}},{"transaction":{"transaction_hash":"0x64a3b4750f807956501570d23565a637357c13a1f405e5d883bf7072f2df912","type":"INVOKE","sender_address":"0x279fde026e3e6cceacb9c263fece0c8d66a8f59e8448f3da5a1968976841c62","calldata":["0x1","0x36031daa264c24520b11d93af622c848b2499b66b41d611bac95e13cfca131a","0x3d0bcca55c118f88a08e0fcc06f43906c0c174feb52ebc83f0fa28a1f59ed67","0x55","0xc","0x0","0x67346f49","0x41564e55","0x41564e55","0x49c7851400","0x4554482f555344","0x0","0x0","0x67346f49","0x41564e55","0x41564e55","0x2c023eb","0x5354524b2f555344","0x0","0x0","0x67346f49","0x41564e55","0x41564e55","0x7f2691c1a01","0x574254432f555344","0x0","0x0","0x67346f49","0x41564e55","0x41564e55","0x57568473d9","0x5753544554482f555344","0x0","0x0","0x67346f49","0x41564e55","0x41564e55","0x78dd9a","0x4c4f5244532f555344","0x0","0x0","0x67346f49","0x41564e55","0x41564e55","0x36ce7065","0x554e492f555344","0x0","0x0","0x67346f49","0x41564e55","0x41564e55","0xf42e3","0x555344432f555344","0x0","0x0","0x67346f49","0x41564e55","0x41564e55","0xf46f9","0x555344542f555344","0x0","0x0","0x67346f49","0x41564e55","0x41564e55","0x5074d59ad2","0x524554482f555344","0x0","0x0","0x67346f49","0x41564e55","0x41564e55","0x92f434","0x5a454e442f555344","0x0","0x0","0x67346f49","0x41564e55","0x41564e55","0x8bc48d","0x4e5354522f555344","0x0","0x0","0x67346f49","0x41564e55","0x41564e55","0x10911160","0x454b55424f2f555344","0x0"],"max_fee":"0xaa87bee538000","version":"0x1","signature":["0x71aa7baa67e388adfa31da8c3ded4c397e939d44a24dea1230238a6bf83a8fa","0x450e6e12c8e4271b5b7e91cb13c65411f35cf986292eda4ffb4b3378f8a190c"],"nonce":"0x6208"},"receipt":{"type":"INVOKE","transaction_hash":"0x64a3b4750f807956501570d23565a637357c13a1f405e5d883bf7072f2df912","actual_fee":{"amount":"0xa3b3bd8860","unit":"WEI"},"execution_status":"SUCCEEDED","finality_status":"ACCEPTED_ON_L2","messages_sent":[],"events":[{"from_address":"0x36031daa264c24520b11d93af622c848b2499b66b41d611bac95e13cfca131a","keys":["0x280bb2099800026f90c334a3a23888ffe718a2920ffbbf4f44c6d3d5efb613c"],"data":["0x67346f49","0x41564e55","0x41564e55","0x49c7851400","0x4554482f555344","0x0"]},{"from_address":"0x36031daa264c24520b11d93af622c848b2499b66b41d611bac95e13cfca131a","keys":["0x280bb2099800026f90c334a3a23888ffe718a2920ffbbf4f44c6d3d5efb613c"],"data":["0x67346f49","0x41564e55","0x41564e55","0x2c023eb","0x5354524b2f555344","0x0"]},{"from_address":"0x36031daa264c24520b11d93af622c848b2499b66b41d611bac95e13cfca131a","keys":["0x280bb2099800026f90c334a3a23888ffe718a2920ffbbf4f44c6d3d5efb613c"],"data":["0x67346f49","0x41564e55","0x41564e55","0x7f2691c1a01","0x574254432f555344","0x0"]},{"from_address":"0x36031daa264c24520b11d93af622c848b2499b66b41d611bac95e13cfca131a","keys":["0x280bb2099800026f90c334a3a23888ffe718a2920ffbbf4f44c6d3d5efb613c"],"data":["0x67346f49","0x41564e55","0x41564e55","0x57568473d9","0x5753544554482f555344","0x0"]},{"from_address":"0x36031daa264c24520b11d93af622c848b2499b66b41d611bac95e13cfca131a","keys":["0x280bb2099800026f90c334a3a23888ffe718a2920ffbbf4f44c6d3d5efb613c"],"data":["0x67346f49","0x41564e55","0x41564e55","0x78dd9a","0x4c4f5244532f555344","0x0"]},{"from_address":"0x36031daa264c24520b11d93af622c848b2499b66b41d611bac95e13cfca131a","keys":["0x280bb2099800026f90c334a3a23888ffe718a2920ffbbf4f44c6d3d5efb613c"],"data":["0x67346f49","0x41564e55","0x41564e55","0x36ce7065","0x554e492f555344","0x0"]},{"from_address":"0x36031daa264c24520b11d93af622c848b2499b66b41d611bac95e13cfca131a","keys":["0x280bb2099800026f90c334a3a23888ffe718a2920ffbbf4f44c6d3d5efb613c"],"data":["0x67346f49","0x41564e55","0x41564e55","0xf42e3","0x555344432f555344","0x0"]},{"from_address":"0x36031daa264c24520b11d93af622c848b2499b66b41d611bac95e13cfca131a","keys":["0x280bb2099800026f90c334a3a23888ffe718a2920ffbbf4f44c6d3d5efb613c"],"data":["0x67346f49","0x41564e55","0x41564e55","0xf46f9","0x555344542f555344","0x0"]},{"from_address":"0x36031daa264c24520b11d93af622c848b2499b66b41d611bac95e13cfca131a","keys":["0x280bb2099800026f90c334a3a23888ffe718a2920ffbbf4f44c6d3d5efb613c"],"data":["0x67346f49","0x41564e55","0x41564e55","0x5074d59ad2","0x524554482f555344","0x0"]},{"from_address":"0x36031daa264c24520b11d93af622c848b2499b66b41d611bac95e13cfca131a","keys":["0x280bb2099800026f90c334a3a23888ffe718a2920ffbbf4f44c6d3d5efb613c"],"data":["0x67346f49","0x41564e55","0x41564e55","0x92f434","0x5a454e442f555344","0x0"]},{"from_address":"0x36031daa264c24520b11d93af622c848b2499b66b41d611bac95e13cfca131a","keys":["0x280bb2099800026f90c334a3a23888ffe718a2920ffbbf4f44c6d3d5efb613c"],"data":["0x67346f49","0x41564e55","0x41564e55","0x8bc48d","0x4e5354522f555344","0x0"]},{"from_address":"0x36031daa264c24520b11d93af622c848b2499b66b41d611bac95e13cfca131a","keys":["0x280bb2099800026f90c334a3a23888ffe718a2920ffbbf4f44c6d3d5efb613c"],"data":["0x67346f49","0x41564e55","0x41564e55","0x10911160","0x454b55424f2f555344","0x0"]},{"from_address":"0x279fde026e3e6cceacb9c263fece0c8d66a8f59e8448f3da5a1968976841c62","keys":["0x1dcde06aabdbca2f80aa51392b345d7549d7757aa855f7e37f5d335ac8243b1","0x64a3b4750f807956501570d23565a637357c13a1f405e5d883bf7072f2df912"],"data":["0x1","0x0"]},{"from_address":"0x49d36570d4e46f48e99674bd3fcc84644ddd6b96f7c741b1562b82f9e004dc7","keys":["0x99cd8bde557814842a3121e8ddfd433a539b8c9f14bf31ebf108d12e6196e9"],"data":["0x279fde026e3e6cceacb9c263fece0c8d66a8f59e8448f3da5a1968976841c62","0x1176a1bd84444c89232ec27754698e5d2e7e1a7f1539f12027f28b23ec9f3d8","0xa3b3bd8860","0x0"]}],"execution_resources":{"steps":79623,"pedersen_builtin_applications":367,"range_check_builtin_applications":2738,"bitwise_builtin_applications":36,"ec_op_builtin_applications":3,"poseidon_builtin_applications":16,"data_availability":{"l1_gas":0,"l1_data_gas":960}}}},{"transaction":{"transaction_hash":"0x3615ebc940bed129609d3d64835b58923d2e7fc3d9bac81caa82829643ff7c0","type":"DEPLOY_ACCOUNT","version":"0x3","signature":["0x1","0x0","0x1520ebb9463c0753e3741d9a87eb6dca5a446c1872544e43dd1a77446465467","0x5f57e800b78abf04200d6de245cfb37ed97dfb1cac4acce5db911e807112d62","0x687be0ae0882738e1040fa7568c2e1fbe52bd019e81fb81eb25ffcd5ec32f26"],"nonce":"0x0","contract_address_salt":"0x1520ebb9463c0753e3741d9a87eb6dca5a446c1872544e43dd1a77446465467","constructor_calldata":["0x0","0x1520ebb9463c0753e3741d9a87eb6dca5a446c1872544e43dd1a77446465467","0x1"],"class_hash":"0x36078334509b514626504edc9fb252328d1a240e4e948bef8d0c08dff45927f","resource_bounds":{"l1_gas":{"max_amount":"0x32","max_price_per_unit":"0x1d513f7e94ae"},"l2_gas":{"max_amount":"0x0","max_price_per_unit":"0x0"}},"tip":"0x0","paymaster_data":[],"nonce_data_availability_mode":"L1","fee_data_availability_mode":"L1"},"receipt":{"type":"DEPLOY_ACCOUNT","transaction_hash":"0x3615ebc940bed129609d3d64835b58923d2e7fc3d9bac81caa82829643ff7c0","actual_fee":{"amount":"0x186e5f94ebf80","unit":"FRI"},"execution_status":"SUCCEEDED","finality_status":"ACCEPTED_ON_L2","messages_sent":[],"events":[{"from_address":"0x5bf379bce33fcf18975ca2195687b4fef201886fa29d9347771e5683735504b","keys":["0x302b4aa3237648863fc569a648f3625780753ababf66d86fd6f7e7bbc648c63","0x5896bcca3ba4617b56aa10418b31e98efcfc7960f9d03c563b4225275fcb95c"],"data":["0x0","0x1520ebb9463c0753e3741d9a87eb6dca5a446c1872544e43dd1a77446465467"]},{"from_address":"0x5bf379bce33fcf18975ca2195687b4fef201886fa29d9347771e5683735504b","keys":["0x1d9ca8a89626bead91b5cb4275a622219e9443975b34f3fdbc683e8621231a9","0x1520ebb9463c0753e3741d9a87eb6dca5a446c1872544e43dd1a77446465467"],"data":["0x0"]},{"from_address":"0x5bf379bce33fcf18975ca2195687b4fef201886fa29d9347771e5683735504b","keys":["0x20609eed4f18b29b5ad13e483b8ab69924632ea4816a40dd30e75437a096abd","0x5896bcca3ba4617b56aa10418b31e98efcfc7960f9d03c563b4225275fcb95c"],"data":["0x0"]},{"from_address":"0x4718f5a0fc34cc1af16a1cdee98ffb20c31f5cd61d6ab07201858f4287c938d","keys":["0x99cd8bde557814842a3121e8ddfd433a539b8c9f14bf31ebf108d12e6196e9"],"data":["0x5bf379bce33fcf18975ca2195687b4fef201886fa29d9347771e5683735504b","0x1176a1bd84444c89232ec27754698e5d2e7e1a7f1539f12027f28b23ec9f3d8","0x186e5f94ebf80","0x0"]}],"contract_address":"0x5bf379bce33fcf18975ca2195687b4fef201886fa29d9347771e5683735504b","execution_resources":{"steps":6647,"pedersen_builtin_applications":29,"range_check_builtin_applications":211,"ec_op_builtin_applications":3,"poseidon_builtin_applications":5,"data_availability":{"l1_gas":0,"l1_data_gas":224}}}},{"transaction":{"transaction_hash":"0x79332353ad7672e0da61caa6a2f3b17a5a46746c959d6a7ff2990e94c51cb00","type":"INVOKE","sender_address":"0x5bf379bce33fcf18975ca2195687b4fef201886fa29d9347771e5683735504b","calldata":["0x2","0x4718f5a0fc34cc1af16a1cdee98ffb20c31f5cd61d6ab07201858f4287c938d","0x83afd3f4caedc6eebf44246fe54e38c95e3179a5ec9ea81740eca5b482d12e","0x3","0x7d33254052409c04510c3652bc5be5656f1eff1b131c7c031592e3fa73f1f70","0x3723a4595d950000","0x0","0x4c5772d1914fe6ce891b64eb35bf3522aeae1315647314aac58b01137607f3f","0xe5b455a836c7a254df57ed39d023d46b641b331162c6c0b369647056655409","0x4","0x455448","0x117ffa811b0620decb2b3df649ff3a5ec533fc0e","0x16345785d8a0000","0x0"],"version":"0x3","signature":["0x1","0x0","0x1520ebb9463c0753e3741d9a87eb6dca5a446c1872544e43dd1a77446465467","0x47e3c137e33970cec36f76fb58ab888b83a3e3a1bca594de9ef9ba2d5bc28ad","0x195265112d9e701360337310f8c09074cb1a025b2efb0c32d2bfe786c1f775e"],"nonce":"0x1","resource_bounds":{"l1_gas":{"max_amount":"0x17ad4","max_price_per_unit":"0x1d513f7edbf3"},"l2_gas":{"max_amount":"0x0","max_price_per_unit":"0x0"}},"tip":"0x0","paymaster_data":[],"account_deployment_data":[],"nonce_data_availability_mode":"L1","fee_data_availability_mode":"L1"},"receipt":{"type":"INVOKE","transaction_hash":"0x79332353ad7672e0da61caa6a2f3b17a5a46746c959d6a7ff2990e94c51cb00","actual_fee":{"amount":"0x9a462b41fe0e5d0","unit":"FRI"},"execution_status":"SUCCEEDED","finality_status":"ACCEPTED_ON_L2","messages_sent":[{"from_address":"0x4c5772d1914fe6ce891b64eb35bf3522aeae1315647314aac58b01137607f3f","to_address":"0x8453fc6cd1bcfe8d4dfc069c400b433054d47bdc","payload":["0x0","0x117ffa811b0620decb2b3df649ff3a5ec533fc0e","0x455448","0x16345785d8a0000","0x0"]}],"events":[{"from_address":"0x4718f5a0fc34cc1af16a1cdee98ffb20c31f5cd61d6ab07201858f4287c938d","keys":["0x99cd8bde557814842a3121e8ddfd433a539b8c9f14bf31ebf108d12e6196e9"],"data":["0x5bf379bce33fcf18975ca2195687b4fef201886fa29d9347771e5683735504b","0x7d33254052409c04510c3652bc5be5656f1eff1b131c7c031592e3fa73f1f70","0x3723a4595d950000","0x0"]},{"from_address":"0x49d36570d4e46f48e99674bd3fcc84644ddd6b96f7c741b1562b82f9e004dc7","keys":["0x99cd8bde557814842a3121e8ddfd433a539b8c9f14bf31ebf108d12e6196e9"],"data":["0x5bf379bce33fcf18975ca2195687b4fef201886fa29d9347771e5683735504b","0x0","0x16345785d8a0000","0x0"]},{"from_address":"0x4c5772d1914fe6ce891b64eb35bf3522aeae1315647314aac58b01137607f3f","keys":["0x282f521c69b2bc696552b9e141009d3c84f2df75e2e7b7716644d31e60f23b1","0x455448","0x117ffa811b0620decb2b3df649ff3a5ec533fc0e","0x5bf379bce33fcf18975ca2195687b4fef201886fa29d9347771e5683735504b"],"data":["0x16345785d8a0000","0x0"]},{"from_address":"0x5bf379bce33fcf18975ca2195687b4fef201886fa29d9347771e5683735504b","keys":["0x1dcde06aabdbca2f80aa51392b345d7549d7757aa855f7e37f5d335ac8243b1","0x79332353ad7672e0da61caa6a2f3b17a5a46746c959d6a7ff2990e94c51cb00"],"data":["0x2","0x1","0x1","0x0"]},{"from_address":"0x4718f5a0fc34cc1af16a1cdee98ffb20c31f5cd61d6ab07201858f4287c938d","keys":["0x99cd8bde557814842a3121e8ddfd433a539b8c9f14bf31ebf108d12e6196e9"],"data":["0x5bf379bce33fcf18975ca2195687b4fef201886fa29d9347771e5683735504b","0x1176a1bd84444c89232ec27754698e5d2e7e1a7f1539f12027f28b23ec9f3d8","0x9a462b41fe0e5d0","0x0"]}],"execution_resources":{"steps":16660,"pedersen_builtin_applications":37,"range_check_builtin_applications":525,"ec_op_builtin_applications":3,"poseidon_builtin_applications":7,"data_availability":{"l1_gas":0,"l1_data_gas":384}}}}]}`),
		},
	}

	for _, test := range tests {
		t.Run(test.name, func(t *testing.T) {
			var res spec.Block
			err := json.Unmarshal(test.input, &res)
			if test.err != "" {
				require.EqualError(t, err, test.err)
			} else {
				require.NoError(t, err)
				rt, err := json.Marshal(&res)
				require.NoError(t, err)
				if len(test.expected) == 0 {
					require.Equal(t, string(test.input), string(rt))
				} else {
					require.Equal(t, string(test.expected), string(rt))
				}
			}
		})
	}
}
